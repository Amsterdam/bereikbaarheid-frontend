suite: Secrets
release:
  name: test
templates:
  - configmap.yaml
tests:
  - it: should have release name as postfix
    set:
      configMaps:
        config1: {}
        config2: {}
    asserts:
      - hasDocuments:
          count: 2
      - isKind:
          of: ConfigMap
      - matchRegex:
          path: metadata.name
          pattern: -test$

  - it: test multiple configmaps
    set:
      configMaps:
        aaa:
          data:
            foo1: bar1
            foo2: bar2
        bbb:
          data:
            hello: world
        ccc:
          data:
            config.ini: |
              [test]
              foo=bar
    asserts:

      - hasDocuments:
          count: 3

      - documentIndex: 0
        equal:
          path: data
          value:
            foo1: bar1
            foo2: bar2

      - documentIndex: 1
        equal:
          path: data
          value:
            hello: world

      - documentIndex: 2
        equal:
          path: data
          value:
            config.ini: |
              [test]
              foo=bar
